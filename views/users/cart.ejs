<!DOCTYPE html>
<html lang="zxx">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Tuime - Animal Food Website Template"/>
    <meta name="keywords" content="accessories, digital products, electronic html, modern, products, responsive"/>
    <meta name="author" content="hastech"/>

    <title>Cart :: Pawty</title>

    <!--== Favicon ==-->
    <link rel="shortcut icon" href="/assets/img/favicon.ico" type="image/x-icon" />

    <!--== Google Fonts ==-->
    <link rel="preconnect" href="https://fonts.googleapis.com/">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600&amp;display=swap" rel="stylesheet">

    <!--== Bootstrap CSS ==-->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet" />
    <!--== Font Awesome Min Icon CSS ==-->
    <link href="/assets/css/font-awesome.min.css" rel="stylesheet" />
    <!--== 7 Stroke Icon CSS ==-->
    <link href="/assets/css/pe-icon-7-stroke.css" rel="stylesheet" />
    <!--== Swiper CSS ==-->
    <link href="/assets/css/swiper.min.css" rel="stylesheet" />
    <!--== Fancybox Min CSS ==-->
    <link href="/assets/css/fancybox.min.css" rel="stylesheet" />
    <!--== Range Slider Min CSS ==-->
    <link href="/assets/css/ion.rangeSlider.min.css" rel="stylesheet" />

    <!--== Main Style CSS ==-->
    <link href="/assets/css/style.css" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    
</head>

<body>

<!--wrapper start-->
<div class="wrapper">

  <!--== Start Header Wrapper ==-->
  <header class="header-area header-default" data-bg-img="assets/img/photos/asset32.png">
    <div class="container">
      <div class="row no-gutter align-items-center position-relative">
        <div class="col-12">
          <div class="header-align">
            <div class="header-align-start">
              <div class="header-logo-area">
                <a href="/">
                  <img class="logo-main" src="assets/img/logo-light.png" width="158" height="36" alt="Logo" />
                </a>
              </div>
            </div>
            <div class="header-align-center">
              <div class="header-navigation-area position-relative">
                <ul class="main-menu nav">
                  <li><a href="/"><span>Home</span></a></li>
                  <li><a href="/about-us"><span>About</span></a></li>
                  <li><a href="/shop"><span>Shop</span></a></li>
                  <li><a href="/contact"><span>Contact</span></a></li>
                </ul>
              </div>
            </div>
            <div class="header-align-end">
              <div class="header-action-area">
                <div class="shopping-search">
                  <button class="shopping-search-btn" type="button" data-bs-toggle="offcanvas" data-bs-target="#AsideOffcanvasSearch" aria-controls="AsideOffcanvasSearch"><i class="pe-7s-search icon"></i></button>
                </div>
                
                <div class="shopping-account">
                  <a class="shopping-account-btn" href="/account">
                    <i class="pe-7s-users icon"></i>
                  </a>
                </div>
                <div class="shopping-wishlist">
                  <a class="shopping-wishlist-btn" href="/wishlist">
                    <i class="pe-7s-like icon"></i>
                  </a>
                </div>
                <div class="shopping-cart">
                  <a class="shopping-cart-btn" href="/cart">
                    <i class="pe-7s-shopbag icon"></i>
                    <sup id="cartBadge" class="shop-count"><%= user.cart.products.length %></sup>
                  </a>
                </div>
                <button class="btn-menu" type="button" data-bs-toggle="offcanvas" data-bs-target="#AsideOffcanvasMenu" aria-controls="AsideOffcanvasMenu">
                  <i class="pe-7s-menu"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>
  <!--== End Header Wrapper ==-->
  
  <main class="main-content">
    <!--== Start Page Header Area Wrapper ==-->
    <!--== End Page Header Area Wrapper ==-->

    <!--== Start Blog Area Wrapper ==-->
    <section class="shopping-cart-area" id="cart-area">
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <div class="shopping-cart-form table-responsive">
              <form action="#" method="post">
                <table class="table text-center">
                  <thead id="cart-table">
                    <tr>
                      <th class="product-remove">&nbsp;</th>
                      <th class="product-thumbnail">&nbsp;product View</th>
                      <th class="product-name">Product</th>
                      <th class="product-price">Price</th>
                      <th class="product-quantity">Quantity</th>
                      <th class="product-subtotal">Total</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% let total = 0; %>
                    <% userCart.products.forEach(product => { %>
                      <% total += product.price*product.quantity; %>
                    <tr class="tbody-item">
                      <td class="product-remove">
                        <button type="button" id="remove-<%= product._id %>" class="remove border-0">x</button>
                      </td>
                      <td class="product-thumbnail">
                        <div class="thumb">
                          <a href="/product/<%= product._id %>">
                            <img src="<%= product.images[0] %>" width="75" height="75" alt="Image-HasTech">
                          </a>
                        </div>
                      </td>
                      <td class="product-name">
                        <a class="title" href="/product/<%= product._id %>"><%= product.productName %></a><br>
                        <% if(product.stock <= 0 ){%>
                          <small class="text-danger"><b>Out of Stock</b></small>
                        <% } %>
                      </td>
                      <td class="product-price">
                        ₹ <span id="price-<%= product._id %>" class="price"><%= product.price %></span>
                      </td>
                      <td class="product-quantity">
                        <div class="">
                          <button type="button" class="qty-minus">-</button>
                          <input type="text" style="width: 28px; border:2px solid black;" class="quantity" title="Quantity" readonly value="<%= product.quantity %>" min="1" data-productId="<%= product._id %>" onchange="updateCart('<%= product._id %>',this.value)">
                          <button type="button" class="qty-plus">+</button>
                        </div><br>
                        <% if(product.stock > 0 && product.quantity > product.stock){ %>
                          <small class="text-danger stock">Stock Exceeded</small>
                        <% } %>
                      </td>                      
                      <td class="product-subtotal">
                        <span id="total-<%= product._id %>" class="price">₹ <%= product.price * product.quantity %> /-</span>
                      </td>
                    </tr>
                    <% }) %>
                  </tbody>
                </table>
              </form>
            </div>
          </div>
        </div>
        <div class="row col-12 g-0 d-flex">

          <div class="col-12 g-0 col-lg-12 d-flex justify-content-center mx-3" id="cart-total">
            <div class="cart-totals-wrap">
              <h4 class="title mt-2">Cart total</h4>
              <table>
                <tbody>
                  <tr class="cart-subtotal">
                    <th>Subtotal</th>
                    <td>
                      <span id="Amount" class="amount">₹  <span id="amount"><%= total %></span> /-</span>
                    </td>
                  </tr>
                  <tr class="cart-subtotal">
                    <th>Shipping Charge</th>
                    <td>
                      <span id="discount" class="amount">₹  <span id="discountVal">0</span> /-</span>
                    </td>
                  </tr>
                  <tr class="cart-subtotal">
                    <th>Discount</th>
                    <td>
                      <span id="discount" class="amount">₹  <span id="discountVal"><%= user.cart.discount %></span> /-</span>
                    </td>
                  </tr>
                  <tr class="cart-subtotal">
                    <th class="">grandTotal</th>
                    <td>
                      <span id="grandTotal" class="amount">₹  <span id="totVal"><%= total - userCart.discount %></span> /-</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <div class="cart-totals-wrap col-12 col-lg-6">
            <div class="text-end">
              <a onclick="toCheckout()" class="checkout-button">Proceed to checkout</a>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section id="emptyCart" style="height:250px;display:none;" class="my-5 mt-5">
      <h2 class="text-secondary w-100 my-5 d-flex justify-content-center">Your Cart is Empty !</h2>
    </section>
    <!--== End Blog Area Wrapper ==-->
  </main>

  <div id="userData" data-user='<%= JSON.stringify(user) %>'></div>
  <script>
    let user = JSON.parse(document.getElementById('userData').dataset.user);
    if(user.cart.products.length === 0){
        document.getElementById('cart-area').style.display = ('none')
        document.getElementById('emptyCart').style.display = ('flex')
      }

      function toCheckout() {
        console.log("working the tochekout function...");
        axios.post('/checkCart')
          .then(response => {
            if (response.status === 200) {
              window.location.href = '/checkout';
            } else if (response.status === 201) {
              console.log("error on quantity.....");
              const message = response.data.message;
              window.location.href = '/cart';
            }
          })
          .catch(error => {
            console.error('Error:', error);
          });
      }




    document.addEventListener('DOMContentLoaded', () => {
      const minusButtons = document.querySelectorAll('.qty-minus');
      const plusButtons = document.querySelectorAll('.qty-plus');
      const quantityInputs = document.querySelectorAll('.quantity');
      const removeButtons = document.querySelectorAll('.remove');
      const discountVal = document.getElementById('discountVal');

//  Decreasing the quantity
      minusButtons.forEach(button => {
        button.addEventListener('click', () => {
          const input = button.nextElementSibling;
          const currentValue = parseInt(input.value);

          if (currentValue > 1) {
            input.value = currentValue - 1;

            // Access the product ID
            const productId = input.getAttribute('data-productId');
            const price = document.getElementById(`price-${productId}`).textContent
            // const productId = input.dataset.productId;
            updateCart(productId, currentValue - 1,price,false);
          }
        });
      });
//  Increasing the quantity
      plusButtons.forEach(button => {
        button.addEventListener('click', () => {
          const input = button.previousElementSibling;
          const currentValue = parseInt(input.value);

          input.value = currentValue + 1;

          // Access the product ID
            const productId = input.getAttribute('data-productId');
            const price = document.getElementById(`price-${productId}`).textContent
            // const productId = input.dataset.productId;
          updateCart(productId, currentValue + 1,price,true);
        });
      });


// Remove product from cart
    removeButtons.forEach(button => {
      button.addEventListener('click', () => {
        const productId = button.id.split('-')[1]; // Extract the product ID from the button ID
        const price = document.getElementById(`price-${productId}`).textContent;
        axios.post('/removeFromCart', { productId, price })
          .then(response => {
            // Handle the response as needed
            console.log('Product removed from cart:', response.data);
            button.closest('.tbody-item').remove(); //remove the specific row
            document.getElementById('amount').textContent = `${response.data.total.toFixed(2)}`;
            document.getElementById('totVal').textContent = `${response.data.total.toFixed(2)}`;
            document.getElementById('cartBadge').innerHTML = response.data.user.cart.products.length;
          })
          .catch(error => {
            console.error('Error removing product from cart:', error.response);
            // Handle errors gracefully (e.g., display an error message to the user)
          });
      });
    });
  });

  function updateCart(productId, quantity, price ,change) {
    const totVal = document.getElementById('totVal');
    const Amount = document.getElementById('amount');
    const InputCoup = document.getElementById('coupon-code');
    const tickmark = document.getElementById('checktrue');
    const crossmark = document.getElementById('checkfalse');
    const couponMessage = document.getElementById('coupon-message');
    discountVal.textContent = 0;

    axios.post('/updateCart', { productId, quantity, price , change })
    .then(response => {
      let subTotal = 0;
      response.data.user.cart.products.forEach(prod => {
        if (prod._id === productId) {
          subTotal += price * quantity;
        } else {
          subTotal += prod.price * prod.quantity;
        }
        document.getElementById(`total-${prod._id}`).textContent = `${prod.price * prod.quantity} /-`;
      });
      Amount.textContent = `${subTotal.toFixed(2)}`;
      totVal.textContent = `${subTotal.toFixed(2)}`;
      document.querySelectorAll('.stock').forEach(element => {
        element.style.display = 'none';
      });

    })
    .catch(error => {
      console.error('Error updating cart quantity:', error.response);
    });
  }

  </script>
  
  

  <!--== Start Footer Area Wrapper ==-->
  <footer class="footer-area">
    <!--== Start Footer Main ==-->
    <div class="footer-main">
      <div class="container pt--0 pb--0">
        <div class="row">
          <div class="col-md-6 col-lg-3">
            <div class="widget-item widget-about">
              <h4 class="widget-title">About Us</h4>
              <p class="desc">Lorem ipsum this is a trial website done by the team pawty for more information contact us on provided informations</p>
              <div class="social-icons">
                <a href="https://www.facebook.com/" target="_blank" rel="noopener"><i class="fa fa-facebook"></i></a>
                <a href="https://dribbble.com/" target="_blank" rel="noopener"><i class="fa fa-dribbble"></i></a>
                <a href="https://www.pinterest.com/" target="_blank" rel="noopener"><i class="fa fa-pinterest-p"></i></a>
                <a href="https://twitter.com/" target="_blank" rel="noopener"><i class="fa fa-twitter"></i></a>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-3">
            <div class="widget-item nav-menu-item1">
              <h4 class="widget-title">Information</h4>
              <h4 class="widget-collapsed-title collapsed" data-bs-toggle="collapse" data-bs-target="#widgetId-1">Information</h4>
              <div id="widgetId-1" class="collapse widget-collapse-body">
                <div class="collapse-body">
                  <div class="widget-menu-wrap">
                    <ul class="nav-menu">
                      <li><a href="/about-us">About Us</a></li>
                      <li><a href="/account">Delivery Information</a></li>
                      <li><a href="/account">Privacy Policy</a></li>
                      <li><a href="/account">Terms & Conditions</a></li>
                      <li><a href="/contact">Contact Us</a></li>
                      <li><a href="/account">Log-In Info</a></li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-3">
            <div class="widget-item nav-menu-item2">
              <h4 class="widget-title">Our Policy</h4>
              <h4 class="widget-collapsed-title collapsed" data-bs-toggle="collapse" data-bs-target="#widgetId-2">Our Policy</h4>
              <div id="widgetId-2" class="collapse widget-collapse-body">
                <div class="collapse-body">
                  <div class="widget-menu-wrap">
                    <ul class="nav-menu">
                      <li><a href="/wishlist">Gallery</a></li>
                      <li><a href="/shop">Brands</a></li>
                      <li><a href="/orders">Gift Certificates</a></li>
                      <li><a href="/shop">Specials</a></li>
                      <li><a href="/account">My Account</a></li>
                      <li><a href="/about-us">About Us</a></li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-3">
            <div class="widget-item">
              <h4 class="widget-title">Contact Info:</h4>
              <h4 class="widget-collapsed-title collapsed" data-bs-toggle="collapse" data-bs-target="#widgetId-3">Contact Info:</h4>
              <div id="widgetId-3" class="collapse widget-collapse-body">
                <div class="collapse-body">
                  <div class="widget-contact-info">
                    <p class="contact-info-desc">If you have any question.please contact us at <a href="mailto://pawtyorg@gmail.com">pawtyorg@gmail.com</a></p>
                    <div class="contact-item">
                      <div class="icon">
                        <i class="pe-7s-map-marker"></i>
                      </div>
                      <div class="info">
                        <p>Pawty<br>Atholi - Calicut , Kerala</p>
                      </div>
                    </div>
                    <div class="contact-item phone-info">
                      <div class="icon">
                        <i class="pe-7s-phone"></i>
                      </div>
                      <div class="info">
                        <p><span>Have any Question</span> <br><a href="tel://0123456789">+91 7012264425</a></p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--== End Footer Main ==-->

    <!--== Start Footer Bottom ==-->
    <div class="footer-bottom">
      <div class="container pt--0 pb--0">
        <div class="row">
          <div class="col-12">
            <div class="footer-bottom-content">
              <p class="copyright">© 2024 Pawty by <a target="_blank" href="#">HAMIM THOYYIB</a></p>
              <div class="payment">
                <a href="/account"><img src="assets/img/photos/payment.png" width="192" height="21" alt="Payment Logo"></a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--== End Footer Bottom ==-->
  </footer>
  <!--== End Footer Area Wrapper ==-->

  <!--== Scroll Top Button ==-->
  <div id="scroll-to-top" class="scroll-to-top"><span class="fa fa-angle-up"></span></div>

  <!--== Start Aside Search Form ==-->
  <aside class="aside-search-box-wrapper offcanvas offcanvas-top" tabindex="-1" id="AsideOffcanvasSearch" aria-labelledby="offcanvasTopLabel">
    <div class="offcanvas-header">
      <h5 class="d-none" id="offcanvasTopLabel">Aside Search</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"><i class="pe-7s-close"></i></button>
    </div>
    <div class="offcanvas-body">
      <div class="container pt--0 pb--0">
        <div class="search-box-form-wrap">
          <div class="search-note">
            <p>Start typing and press Enter to search</p>
          </div>
          <form action="#" method="post">
            <div class="search-form position-relative">
              <label for="search-input" class="visually-hidden">Search</label>
              <input id="search-input" type="search" class="form-control" placeholder="Search entire store…">
              <button class="search-button"><i class="fa fa-search"></i></button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </aside>
  <!--== End Aside Search Form ==-->

  <!--== Start Aside Menu ==-->
  <aside class="off-canvas-wrapper offcanvas offcanvas-start" tabindex="-1" id="AsideOffcanvasMenu" aria-labelledby="offcanvasExampleLabel">
    <div class="offcanvas-header">
      <h1 class="d-none" id="offcanvasExampleLabel">Aside Menu</h1>
      <button class="btn-menu-close" data-bs-dismiss="offcanvas" aria-label="Close">menu <i class="fa fa-chevron-left"></i></button>
    </div>
    <div class="offcanvas-body">
      <nav id="offcanvasNav" class="offcanvas-menu-nav">
        <ul>
          <li class="offcanvas-nav-parent">
            <a class="offcanvas-nav-item" href="/">Home</a>
          </li>
          <li class="offcanvas-nav-parent">
            <a class="offcanvas-nav-item" href="/shop">Shop</a>
          </li>
          <li class="offcanvas-nav-parent">
            <a class="offcanvas-nav-item" href="/about">about</a>
          </li>
          <li class="offcanvas-nav-parent">
            <a class="offcanvas-nav-item" href="/contact">Contact</a>
          </li>
        </ul>
      </nav>
    </div>
  </aside>
  <!--== End Aside Menu ==-->
</div>

<!--=======================Javascript============================-->

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<!--=== jQuery Modernizr Min Js ===-->
<script src="/assets/js/modernizr.js"></script>
<!--=== jQuery Min Js ===-->
<script src="/assets/js/jquery-main.js"></script>
<!--=== jQuery Migration Min Js ===-->
<script src="/assets/js/jquery-migrate.js"></script>
<!--=== jQuery Popper Min Js ===-->
<script src="/assets/js/popper.min.js"></script>
<!--=== jQuery Bootstrap Min Js ===-->
<script src="/assets/js/bootstrap.min.js"></script>
<!--=== jQuery Swiper Min Js ===-->
<script src="/assets/js/swiper.min.js"></script>
<!--=== jQuery Fancybox Min Js ===-->
<script src="/assets/js/fancybox.min.js"></script>
<!--=== jQuery Countdown Min Js ===-->
<script src="/assets/js/countdown.js"></script>
<!--=== jQuery Isotope Min Js ===-->
<script src="/assets/js/isotope.pkgd.min.js"></script>
<!--=== jQuery Range Slider Min Js ===-->
<script src="/assets/js/ion.rangeSlider.min.js"></script>

<!--=== jQuery Custom Js ===-->
<script src="/assets/js/custom.js"></script>

</body>


<!-- Mirrored from htmldemo.net/tuime/tuime/shop-cart.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 10 Feb 2024 04:43:18 GMT -->
</html>